digits(50);
q = 0.1;
r = 0.1;
p = 0.1;
k = 0;
%y
input = [-0.040916 -0.074321 -0.101781 -0.064751 -0.061077 -0.046956 -0.026044 -0.016607 -0.002131 -0.010469 -0.004114 0.014282 0.015038 0.039980 0.030375 0.052835 0.041193 0.042477 0.047760 0.070684 0.081095 0.081143 0.091014 0.080012 0.113148 0.122718 0.122993 0.149940 0.147159 0.134220 0.141997 0.150367 0.158014 0.165092 0.163998 0.182852 0.175470 0.178105 0.195423 0.186452 0.199762 0.220628 0.209632 0.215375 0.213521 0.224563 0.221808 0.229021 0.242291 0.233062 0.248737 0.243483 0.243255 0.244411 0.241450 0.250185 0.274204 0.251648 0.270957 0.279446 0.261918 0.289584 0.298224 0.305351 0.294537 0.299673 0.314559 0.303312 0.317234 0.319956 0.336578 0.318982 0.342856 0.337077 0.349245 0.371017 0.336734 0.379998 0.336095 0.377977 0.370779 0.383092 0.386899 0.378611 0.395039 0.400336 0.392896 0.406962 0.416680 0.414059 0.416797 0.437945 0.407906 0.444492 0.429052 0.441293 0.450691 0.448972 0.454307 0.453713 0.463312 0.469881 0.466223 0.489533 0.487494 0.502571 0.492869 0.495676 0.503084 0.516483 0.517764 0.542320 0.519802 0.537321 0.544364 0.538566 0.539921 0.567024 0.565122 0.566660 0.574916 0.587328 0.586310 0.595683 0.577089 0.584550 0.595528 0.610651 0.626644 0.607704 0.640085 0.633008 0.654435 0.636603 0.652899 0.666006 0.668015 0.666503 0.673487 0.686110 0.686957 0.698155 0.695521 0.702732 0.699509 0.698755 0.709453 0.703335 0.715284 0.704679 0.717251 0.726004 0.689571 0.771102 0.738013 0.755029 0.751254 0.740026 0.762166 0.748412 0.795112 0.751503 0.779414 0.776426 0.759644 0.790933 0.752423 0.804601 0.752872 0.791747 0.802393 0.785707 0.816062 0.791149 0.817958 0.813821 0.797902 0.819361 0.802054 0.816717 0.812958 0.831952 0.841111 0.861119 0.833631 0.857848 0.850535 0.865857 0.874580 0.862605 0.874502 0.852610 0.889129 0.873091 0.885928 0.872684 0.884190 0.871168 0.889567 0.871333 0.879228 0.887261 0.884515 0.914814 0.861523 0.924168 0.897770 0.902892 0.911893 0.894390 0.871305 0.925707 0.899630 0.916301 0.941206 0.923194 0.922666 0.921879 0.909105 0.957091 0.900715 0.947025 0.927293 0.948448 0.943918 0.924720 0.939068 0.956889 0.959194 0.944245 0.997013 0.926738 0.975423 0.934885 0.961934 0.966153 0.932012 0.968891 0.950991 0.982985 0.960190 0.992780 0.938892 0.987733 0.960556 0.951690 0.963923 0.986564 0.972950 0.930252 0.989387 0.956795 0.991921 0.984971 0.985953 0.983806 0.963966 1.001695 0.964365 1.011156 0.994907 0.987417 0.990604 0.986862 0.985739 1.040635 0.951283 0.994227 1.001242 0.983217 0.974355 1.011599 0.966553 1.026161 0.933339 1.001450 1.027655 0.962282 1.010448 0.959977 1.032601 0.942517 1.049549 0.950778 1.045744 0.967086 1.007373 0.967219 0.993587 1.018323 0.933858 1.036690 0.947500 0.999357 0.951035 0.962575 1.015530 0.951390 0.969936 0.980972 1.001455 0.977920 0.997212 0.919732 1.007956 1.007374 0.951172 1.004328 0.976650 1.009356 0.953448 1.001882 0.884214 0.992621 0.938950 0.984037 0.997330 0.947132 1.020691 0.901401 1.020201 0.925968 0.989565 0.976111 0.962201 0.966085 0.926825 0.977210 0.947448 0.984877 0.936898 0.967834 0.962667 0.961955 0.944963 0.969456 0.974975 0.934709 0.971066 0.923313 0.976324 0.934990 0.985070 0.933313 0.971792 0.980651 0.928961 0.938621 0.983820];
x = input(1);
[M,I]= min(input);
j = input(I+1);
k = input(I+2);
output = zeros(1,349);
for i = 1:349
    p = p+q;
    k = p/(p+r);
    x = x+k*(input(i)-x);
    output(i) = x;
    p = (1-k)*p;
end

q2= 0.01;
output2 = zeros(1,349);
x = input(1);
for i = 1:349
    p = p+q2;
    k = p/(p+r);
    x = x+k*(input(i)-x);
    output2(i) = x;
    p = (1-k)*p;
end

q3 = 0.005;
output3 = zeros(1,349);
x = input(1);
for i = 1:349
    p = p+q3;
    k = p/(p+r);
    x = x+k*(input(i)-x);
    output3(i) = x;
    p = (1-k)*p;
end

q4 = 0.03;
output4 = zeros(1,349);
x = input(1);
for i = 1:349
    p = p+q4;
    k = p/(p+r);
    x = x+k*(input(i)-x);
    output4(i) = x;
    p = (1-k)*p;
end

q5 = 0.03;
r5 = 0.1;
output5 = zeros(1,349);
x = input(1);
for i = 1:349
    p = p+q5;
    k = p/(p+r5);
    x = x+k*(input(i)-x);
    output5(i) = x;
    p = (1-k)*p;
end

q6 = 0.03;
r6 = 0.01;
output6 = zeros(1,349);
x = input(1);
for i = 1:349
    p = p+q6;
    k = p/(p+r6);
    x = x+k*(input(i)-x);
    output6(i) = x;
    p = (1-k)*p;
end

q7 = 0.03;
r7 = 0.048;
output7 = zeros(1,349);
x = input(1);
for i = 1:349
    p = p+q7;
    k = p/(p+r7);
    x = x+k*(input(i)-x);
    output7(i) = x;
    p = (1-k)*p;
end

q8 = 0.03;
r8 = 0.048;
output8 = zeros(1,349);
x = input(1);
for i = 1:349
    p = p+q8;
    k = p/(p+r8);
    x = x+k*(input(i)-x);
    output8(i) = x;
    p = (1-k)*p;
end
figure
plot(input);
%hold on
%plot(output);
%hold on
%plot(output2);
%hold on
%plot(output3);
%hold on
%plot(output4);
%hold on
%plot(output5);
%hold on
%plot(output6);
%hold on
%plot(output7);
hold on
plot(output8);
%legend('input', 'output', 'output2', 'output3', 'output4')
legend('input', 'output5', 'output6', 'output7', 'output8')
%legend('input', 'output', 'output2', 'output3', 'output4', 'output5', 'output6', 'output7', 'output8')
