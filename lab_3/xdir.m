digits(50);
q = 0.1;
r = 0.1;
p = 0.1;
k = 0;
%x
input = [-0.050519 -0.016794 -0.041729 0.023983 0.024057 -0.036519 -0.035186 -0.019090 -0.012721 -0.006418 -0.043106 -0.041713 -0.130663 -0.013824 -0.012149 -0.038884 -0.042487 0.014486 0.004595 0.040254 0.047549 0.073901 0.078509 0.068283 0.083661 0.086603 0.121573 0.132106 0.111400 0.133820 0.154759 0.142209 0.152282 0.160059 0.184276 0.185596 0.187046 0.196243 0.231976 0.222848 0.229596 0.230057 0.257476 0.258915 0.260131 0.283582 0.297887 0.297531 0.314502 0.304594 0.327193 0.318703 0.317774 0.345797 0.334738 0.346810 0.355198 0.350328 0.359317 0.379568 0.392328 0.384453 0.383553 0.402422 0.400588 0.403764 0.423107 0.411868 0.443023 0.430781 0.434542 0.438814 0.441329 0.448252 0.448376 0.452237 0.458758 0.469119 0.478336 0.484723 0.489296 0.495412 0.493368 0.514931 0.509573 0.504465 0.521914 0.525576 0.531194 0.529283 0.531628 0.544326 0.544224 0.567010 0.562930 0.561625 0.563386 0.569150 0.584853 0.578133 0.579468 0.585501 0.592390 0.592183 0.609026 0.602527 0.590995 0.615361 0.630808 0.627855 0.632429 0.619384 0.630098 0.647224 0.625726 0.664230 0.636566 0.660225 0.654932 0.656855 0.650707 0.666509 0.674391 0.667424 0.687674 0.669907 0.671900 0.710867 0.684214 0.701982 0.706024 0.702676 0.703133 0.726094 0.714713 0.718622 0.730538 0.713024 0.719433 0.750968 0.739281 0.754771 0.756645 0.766275 0.764010 0.766979 0.782100 0.775270 0.777756 0.797899 0.775250 0.800330 0.799411 0.792327 0.800512 0.815290 0.811081 0.809023 0.810382 0.811119 0.821814 0.816730 0.818555 0.798740 0.853451 0.840495 0.823487 0.824600 0.836664 0.832963 0.853605 0.848723 0.844614 0.854369 0.859384 0.856536 0.867768 0.868322 0.884795 0.860796 0.882432 0.881849 0.862883 0.900842 0.894454 0.896505 0.891325 0.897815 0.886731 0.909653 0.891475 0.890287 0.892141 0.912162 0.915656 0.914811 0.921647 0.901025 0.931166 0.920465 0.904634 0.905292 0.951873 0.927192 0.973672 0.968473 0.952011 0.958096 0.937982 0.938919 0.948788 0.938040 0.961568 0.968147 0.932535 0.978795 0.968405 0.946433 0.945745 0.951973 0.964024 0.968578 0.963920 0.970302 1.002753 0.973804 0.987030 0.979417 0.954105 0.994560 0.994482 0.986325 0.998779 0.990460 0.993886 0.992731 1.002509 0.997919 1.007032 1.024626 1.011312 1.005885 0.989719 1.001006 1.020355 1.017327 1.022403 1.011409 1.017022 1.016912 1.010700 1.025341 1.020154 1.034534 1.012746 1.024823 1.013249 1.027568 1.040009 1.030648 1.041073 1.001534 1.048010 1.026118 1.039398 1.039205 1.013695 1.030501 1.009680 1.063730 1.054441 0.994048 1.109631 1.040581 1.025385 1.036509 1.021228 1.055950 1.018226 1.031730 1.045011 1.056326 1.067188 1.008100 1.020032 1.031729 1.037185 1.052092 1.002367 1.040159 1.051023 1.043639 1.014754 1.056765 1.035900 1.021444 1.040236 1.024345 1.051571 1.035504 1.027617 1.030207 1.042501 1.005024 1.008554 1.041164 1.024356 1.040155 1.038407 1.029594 1.039189];
x = input(1);
[M,I]= min(input);
j = input(I+1);
k = input(I+2);
output = zeros(1,311);
for i = 1:311
    p = p+q;
    k = p/(p+r);
    x = x+k*(input(i)-x);
    output(i) = x;
    p = (1-k)*p;
end

q2= 0.01;
output2 = zeros(1,311);
x = input(1);
for i = 1:311
    p = p+q2;
    k = p/(p+r);
    x = x+k*(input(i)-x);
    output2(i) = x;
    p = (1-k)*p;
end

q3 = 0.001;
output3 = zeros(1,311);
x = input(1);
for i = 1:311
    p = p+q3;
    k = p/(p+r);
    x = x+k*(input(i)-x);
    output3(i) = x;
    p = (1-k)*p;
end

q4 = 0.03;
output4 = zeros(1,311);
x = input(1);
for i = 1:311
    p = p+q4;
    k = p/(p+r);
    x = x+k*(input(i)-x);
    output4(i) = x;
    p = (1-k)*p;
end

q5 = 0.03;
r5 = 0.1;
output5 = zeros(1,311);
x = input(1);
for i = 1:311
    p = p+q5;
    k = p/(p+r5);
    x = x+k*(input(i)-x);
    output5(i) = x;
    p = (1-k)*p;
end

q6 = 0.03;
r6 = 0.05;
output6 = zeros(1,311);
x = input(1);
for i = 1:311
    p = p+q6;
    k = p/(p+r6);
    x = x+k*(input(i)-x);
    output6(i) = x;
    p = (1-k)*p;
end

q7 = 0.03;
r7 = 0.02;
output7 = zeros(1,311);
x = input(1);
for i = 1:311
    p = p+q7;
    k = p/(p+r7);
    x = x+k*(input(i)-x);
    output7(i) = x;
    p = (1-k)*p;
end

q8 = 0.03;
r8 = 0.048;
output8 = zeros(1,311);
x = input(1);
for i = 1:311
    p = p+q8;
    k = p/(p+r8);
    x = x+k*(input(i)-x);
    output8(i) = x;
    p = (1-k)*p;
end
figure
plot(input);
%hold on
%plot(output);
%hold on
%plot(output2);
%hold on
%plot(output3);
%hold on
%plot(output4);
hold on
plot(output5);
hold on
plot(output6);
hold on
plot(output7);
hold on
plot(output8);
%legend('input', 'output', 'output2', 'output3', 'output4')
legend('input', 'output5', 'output6', 'output7', 'output8')
%legend('input', 'output', 'output2', 'output3', 'output4', 'output5', 'output6', 'output7', 'output8')
