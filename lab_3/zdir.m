digits(50);
q = 0.1;
r = 0.1;
p = 0.1;
k = 0;
%z
input = [0.053750 0.055504 0.061124 0.131110 0.130456 0.122012 0.143022 0.150161 0.173668 0.215734 0.202808 0.208056 0.252163 0.269556 0.287247 0.26 0.296125 0.287872 0.298683 0.307601 0.312841 0.318353 0.326654 0.316366 0.347129 0.333834 0.347304 0.330574 0.362105 0.353313 0.355759 0.345300 0.366135 0.371174 0.362205 0.388097 0.366985 0.392325 0.407126 0.404324 0.414265 0.402963 0.406716 0.420859 0.438352 0.414182 0.445522 0.433177 0.453534 0.408276 0.438078 0.476552 0.453302 0.478558 0.452860 0.476642 0.487217 0.455023 0.480585 0.459800 0.466507 0.467723 0.509701 0.483594 0.504672 0.500471 0.495933 0.497883 0.496176 0.509892 0.498234 0.514896 0.509471 0.494330 0.521503 0.522551 0.518351 0.520305 0.531503 0.512939 0.550821 0.530178 0.555700 0.537533 0.540809 0.547206 0.545493 0.557666 0.549791 0.556314 0.558757 0.555407 0.561331 0.555166 0.574752 0.587865 0.565036 0.579407 0.578598 0.576572 0.579845 0.585109 0.585054 0.590313 0.595646 0.602917 0.587167 0.603697 0.602954 0.603698 0.605506 0.622318 0.605367 0.622212 0.618599 0.615496 0.639136 0.625456 0.631448 0.634356 0.642855 0.648786 0.648546 0.644848 0.665874 0.645776 0.672455 0.658977 0.662867 0.681694 0.664328 0.672078 0.669070 0.683577 0.676944 0.681839 0.706470 0.690494 0.702817 0.697348 0.704969 0.711829 0.719577 0.715615 0.718171 0.713923 0.725109 0.721202 0.761352 0.728110 0.738424 0.758387 0.735260 0.757915 0.748178 0.756135 0.752780 0.732217 0.771048 0.771482 0.764628 0.775407 0.757281 0.771464 0.773400 0.775548 0.776348 0.787901 0.766915 0.793008 0.775244 0.793281 0.789336 0.777395 0.783859 0.798677 0.810564 0.809276 0.808304 0.803016 0.802650 0.805154 0.820202 0.814836 0.814438 0.813999 0.844531 0.808185 0.829219 0.816626 0.825922 0.830263 0.836112 0.828564 0.828201 0.846530 0.821798 0.858963 0.842241 0.818345 0.857739 0.844462 0.855746 0.858932 0.849665 0.882977 0.889585 0.883026 0.880974 0.886795 0.894967 0.895371 0.906851 0.902562 0.913228 0.905760 0.922931 0.935199 0.913828 0.931686 0.914203 0.927964 0.930144 0.933167 0.931363 0.933874 0.927118 0.933700 0.936795 0.944770 0.943028 0.943236 0.936900 0.939873 0.956177 0.936822 0.963535 0.939093 0.957276 0.954516 0.951575 0.976463 0.954958 0.964703 0.987663 0.960875 0.989453 0.975999 0.983706 0.967929 0.991832 0.999689 0.989207 1.002012 1.002965 0.990527 1.002778 1.002887 0.993530 1.028782 0.996606 1.018284 1.008181 1.021533 1.021856 1.020337 1.011062 1.013590 1.033599 1.010311 1.021596 1.037637 1.005392 1.028546 1.014844 1.021153 1.039474 1.003963 1.025648 1.030537 1.031986 1.016481 1.029970 1.015157 1.036415 1.028897 1.046014 1.013647 1.025645 1.016895 1.036949 1.039464 1.023138 1.040397 0.984907 1.014339 1.019895 1.031502 1.034538 0.998243 1.039598 1.014499 1.015446 1.049180 1.027794 1.014691 0.978786 1.034897 0.969256 1.016100 1.022326 1.074521 1.067900 1.024821 1.031221 1.027401 1.053970 0.930699 0.993487 0.973103 1.013378 1.057014 0.884561 1.075997 0.961250 1.087669 1.028118 0.997702 1.028872 1.031343 1.008455 1.015873 1.029006 0.976374 1.010937 1.069764 0.955239 1.026866 1.038443 0.969097 1.063823 0.945758 1.068163 0.979932 1.024285 1.020504 0.990677 1.007310 0.981047 0.969480 1.024047 0.955594 1.089546];
x = input(1);
[M,I]= min(input);
j = input(I+1);
k = input(I+2);
output = zeros(1,353);
for i = 1:353
    p = p+q;
    k = p/(p+r);
    x = x+k*(input(i)-x);
    output(i) = x;
    p = (1-k)*p;
end

q2= 0.01;
output2 = zeros(1,353);
x = input(1);
for i = 1:353
    p = p+q2;
    k = p/(p+r);
    x = x+k*(input(i)-x);
    output2(i) = x;
    p = (1-k)*p;
end

q3 = 0.05;
output3 = zeros(1,353);
x = input(1);
for i = 1:353
    p = p+q3;
    k = p/(p+r);
    x = x+k*(input(i)-x);
    output3(i) = x;
    p = (1-k)*p;
end

q4 = 0.07;
output4 = zeros(1,353);
x = input(1);
for i = 1:353
    p = p+q4;
    k = p/(p+r);
    x = x+k*(input(i)-x);
    output4(i) = x;
    p = (1-k)*p;
end

q5 = 0.07;
r5 = 0.1;
output5 = zeros(1,353);
x = input(1);
for i = 1:353
    p = p+q5;
    k = p/(p+r5);
    x = x+k*(input(i)-x);
    output5(i) = x;
    p = (1-k)*p;
end

q6 = 0.07;
r6 = 1;
output6 = zeros(1,353);
x = input(1);
for i = 1:353
    p = p+q6;
    k = p/(p+r6);
    x = x+k*(input(i)-x);
    output6(i) = x;
    p = (1-k)*p;
end

q7 = 0.03;
r7 = 0.48;
output7 = zeros(1,353);
x = input(1);
for i = 1:353
    p = p+q7;
    k = p/(p+r7);
    x = x+k*(input(i)-x);
    output7(i) = x;
    p = (1-k)*p;
end

q8 = 0.07;
r8 = 0.48;
output8 = zeros(1,353);
x = input(1);
for i = 1:353
    p = p+q8;
    k = p/(p+r8);
    x = x+k*(input(i)-x);
    output8(i) = x;
    p = (1-k)*p;
end
figure
plot(input);
hold on
%plot(output);
%hold on
%plot(output2);
%hold on
%plot(output3);
%hold on
%plot(output4);
%hold on
%plot(output5);
%hold on
%plot(output6);
%hold on
plot(output7);
hold on
plot(output8);
%legend('input', 'output', 'output2', 'output3', 'output4')
legend('input', 'output5', 'output6', 'output7', 'output8')
%legend('input', 'output', 'output2', 'output3', 'output4', 'output5', 'output6', 'output7', 'output8')
